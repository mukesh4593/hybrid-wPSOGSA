% Code of calculating cost function for 1D MT inversion 
% Developer-This code was Generated by SeyedAli Mirjalili, 2011, A New Hybrid PSOGSA for mathematical benchmark function 
% modified by Mukesh Mukesh, kuldeep Sarkar and Upendra K. Singh for geophysical data for academic purpose in 2019.
%%Input
% mm:number of observation point
% dataFrequencies: number of frequencies in the given range
% r_obs: observed apparent resistivity
% p_obs: observed apparent phase

%%Output
% fit:misfit error

function [fit,r_cal,p_cal]=benchmark_functions(mm,dataFrequencies,r_obs,p_obs)

nnn =length(r_obs);
for k = 1:nnn
a=round(length(mm)/2);
[r_cal(k,1),p_cal(k,1)] = forward(mm(1:a), mm(a+1:5),dataFrequencies(k));

end
% e1=sqrt(mean((r_cal-r_obs).^2));%RMS error
% fit=norm(e1,2);%objective function L2 Norm
fit=RMS_1(r_cal,r_obs);
end
